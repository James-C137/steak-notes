---
import { getCollection, render } from 'astro:content';
import Base from '../../layouts/Base.astro';
import Tags from '../../components/Tags.tsx';

export async function getStaticPaths() {
  const recipes = await getCollection('recipes');
  return recipes.map((recipe) => ({
    params: { slug: recipe.id },
    props: { recipe },
  }));
}

const { recipe } = Astro.props;
const { Content } = await render(recipe);
---

<Base title={recipe.data.title} description={recipe.data.description} showProgress>
  <article class="max-w-3xl mx-auto px-6 py-12">
    <header class="mb-12">
      {recipe.data.tags && <div class="mb-4"><Tags tags={recipe.data.tags} /></div>}
      <div class="bg-ochre border-3 border-charcoal rounded-lg p-6 shadow-brutal">
        <h1 class="text-5xl font-black mb-4 text-cream">{recipe.data.title}</h1>
        <p class="text-xl text-cream/80">{recipe.data.description}</p>
      </div>
    </header>

    <div class="prose prose-lg prose-brutal max-w-none
                prose-headings:font-black prose-headings:text-charcoal
                prose-h2:text-2xl prose-h2:mt-12 prose-h2:mb-6 prose-h2:pb-2 prose-h2:border-b-3 prose-h2:border-charcoal
                prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-4
                prose-p:text-ink prose-p:leading-relaxed
                prose-strong:text-charcoal
                prose-a:text-ochre prose-a:font-bold prose-a:no-underline hover:prose-a:underline">
      <Content />
    </div>

    <footer class="mt-16 pt-8 border-t-3 border-charcoal">
      <a href="/" class="brutal-button inline-block">
        â† Back to recipes
      </a>
    </footer>
  </article>
</Base>
