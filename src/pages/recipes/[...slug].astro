---
import { getCollection, render } from 'astro:content';
import Base from '../../layouts/Base.astro';
import Tags from '../../components/Tags.tsx';
import Card from '../../components/Card.astro';
import FlyingSteaks from '../../components/FlyingSteaks.astro';

export async function getStaticPaths() {
  const recipes = await getCollection('recipes');
  return recipes.map((recipe) => ({
    params: { slug: recipe.id },
    props: { recipe },
  }));
}

const { recipe } = Astro.props;
const { Content } = await render(recipe);
---

<Base title={recipe.data.title} description={recipe.data.description} showProgress>
  <article class="max-w-3xl mx-auto px-6 py-12">
    <header class="mb-8">
      {recipe.data.tags && <div class="mb-4"><Tags tags={recipe.data.tags} /></div>}
      <Card background="bg-ochre" padding="px-6 py-8" class="cursor-pointer select-none" data-steak-target>
        <h1 class="text-5xl font-black mb-4 text-cream">{recipe.data.title}</h1>
        <p class="text-xl text-cream/80">{recipe.data.description}</p>
      </Card>
    </header>

    <div class="prose-brutal max-w-none">
      <Content />
    </div>

    <footer class="mt-16 pt-8 border-t-3 border-charcoal">
      <a href={import.meta.env.BASE_URL} class="brutal-button inline-block">
        â† Back to recipes
      </a>
    </footer>
  </article>
  <FlyingSteaks />
</Base>
